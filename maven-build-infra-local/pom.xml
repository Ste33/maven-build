<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>cn.home1</groupId>
        <artifactId>maven-build</artifactId>
        <version>3.0.0-SNAPSHOT</version>
    </parent>

    <artifactId>maven-build-infra-local</artifactId>
    <description>Parent pom for maven projects that deploy to local nexus3</description>
    <name>maven-build-infra-local</name>
    <packaging>pom</packaging>

    <pluginRepositories>
        <!-- @formatter:off -->
        <pluginRepository>
            <id>central</id><name>central</name><url>https://repo1.maven.org/maven2</url>
            <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases><snapshots><enabled>false</enabled></snapshots>
        </pluginRepository>
        <pluginRepository>
            <id>ossrh-snapshots</id>
            <name>central snapshots</name>
            <url>https://oss.sonatype.org/content/repositories/snapshots/</url>
            <releases><enabled>false</enabled></releases>
            <snapshots><enabled>true</enabled><updatePolicy>daily</updatePolicy></snapshots>
        </pluginRepository>
        <pluginRepository>
            <id>ossrh-thirdparty</id>
            <name>central thirdparty</name>
            <url>https://oss.sonatype.org/content/repositories/third-party-releases/</url>
            <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases>
            <snapshots><enabled>false</enabled></snapshots>
        </pluginRepository>
        <!-- @formatter:on -->
    </pluginRepositories>

    <profiles>
        <!-- @formatter:off -->
        <profile>
            <id>infrastructure_local</id>
            <activation><property><name>infrastructure</name><value>local</value></property></activation>
            <distributionManagement>
                <repository><id>local-releases</id><url>${local.nexus3}repository/maven-releases/</url></repository>
                <snapshotRepository><id>local-snapshots</id><url>${local.nexus3}repository/maven-snapshots/</url></snapshotRepository>
            </distributionManagement>
            <pluginRepositories>
                <pluginRepository>
                    <id>local-releases</id>
                    <name>local releases</name>
                    <url>${local.nexus3}repository/maven-releases/</url>
                    <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases>
                    <snapshots><enabled>false</enabled></snapshots>
                </pluginRepository>
                <pluginRepository>
                    <id>local-snapshots</id>
                    <name>local snapshots</name>
                    <url>${local.nexus3}repository/maven-snapshots/</url>
                    <releases><enabled>false</enabled></releases>
                    <snapshots><enabled>true</enabled><updatePolicy>daily</updatePolicy></snapshots>
                </pluginRepository>
                <pluginRepository>
                    <id>local-thirdparty</id>
                    <name>local thirdparty</name>
                    <url>${local.nexus3}repository/maven-thirdparty/</url>
                    <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases>
                    <snapshots><enabled>true</enabled><updatePolicy>daily</updatePolicy></snapshots>
                </pluginRepository>
            </pluginRepositories>
            <properties>
                <docker.registry.url>${local.docker.registry.url}</docker.registry.url>
                <!--<nexus2>${local.nexus2}</nexus2>-->
                <nexus3>${local.nexus3}</nexus3>
                <!--sonar.jdbc.url>jdbc:h2:tcp://sonarqube.local/sonar</sonar.jdbc.url>
                <sonar.jdbc.url>jdbc:postgresql://postgresql:5432/sonar</sonar.jdbc.url-->
                <sonar.host.url>${local.sonar.host.url}</sonar.host.url>
            </properties>
            <repositories>
                <repository>
                    <id>local-releases</id>
                    <name>local releases</name>
                    <url>${local.nexus3}repository/maven-releases/</url>
                    <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases>
                    <snapshots><enabled>false</enabled></snapshots>
                </repository>
                <repository>
                    <id>local-snapshots</id>
                    <name>local snapshots</name>
                    <url>${local.nexus3}repository/maven-snapshots/</url>
                    <releases><enabled>false</enabled></releases>
                    <snapshots><enabled>true</enabled><updatePolicy>daily</updatePolicy></snapshots>
                </repository>
                <repository>
                    <id>local-thirdparty</id>
                    <name>local thirdparty</name>
                    <url>${local.nexus3}repository/maven-thirdparty/</url>
                    <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases>
                    <snapshots><enabled>true</enabled><updatePolicy>daily</updatePolicy></snapshots>
                </repository>
            </repositories>
        </profile>

        <profile>
            <id>infrastructure_local-dav-site</id>
            <activation><property><name>github.site.publish</name><value>false</value></property></activation>
            <distributionManagement>
                <!-- scpexe uses privateKey, scp uses password -->
                <!-- scpexe://${domain_or_ip}:22/path/to/sites -->
                <site><id>local-mvnsite</id><url>dav:${local.nexus3}repository/mvnsite/${site.path}/</url></site>
            </distributionManagement>
        </profile>
        <!-- @formatter:on -->
    </profiles>

    <!-- @formatter:off -->
    <properties>
        <checkstyle.config.location>https://github.com/ci-and-cd/maven-build/raw/master/src/main/checkstyle/google_checks_8.10.xml</checkstyle.config.location>
        <local.docker.registry.url>http://nexus3:5000/v2/</local.docker.registry.url>
        <!--<local.nexus2>http://nexus2:28081/nexus/</local.nexus2>-->
        <local.nexus3>http://nexus3:38081/nexus/</local.nexus3>
        <local.sonar.host.url>http://sonarqube:9000</local.sonar.host.url>
        <pmd.ruleset.location>https://github.com/ci-and-cd/maven-build/raw/master/src/main/pmd/pmd-ruleset-6.8.0.xml</pmd.ruleset.location>
    </properties>
    <!-- @formatter:on -->

    <!-- @formatter:off -->
    <repositories>
        <repository>
            <id>ossrh-releases</id><name>central releases</name><url>https://oss.sonatype.org/content/repositories/releases/</url>
            <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases><snapshots><enabled>false</enabled></snapshots>
        </repository>
        <repository>
            <id>ossrh-snapshots</id><name>central snapshots</name><url>https://oss.sonatype.org/content/repositories/snapshots/</url>
            <releases><enabled>false</enabled></releases><snapshots><enabled>true</enabled><updatePolicy>daily</updatePolicy></snapshots>
        </repository>
        <repository>
            <id>ossrh-thirdparty</id>
            <name>central thirdparty</name>
            <url>https://oss.sonatype.org/content/repositories/third-party-releases/</url>
            <releases><enabled>true</enabled><updatePolicy>never</updatePolicy></releases>
            <snapshots><enabled>false</enabled></snapshots>
        </repository>
    </repositories>
    <!-- @formatter:on -->
</project>
